# xai-unreliability-aprc

# Image Probability and Kendall's Tau Calculator

This repository contains two Python scripts:
1. `generate_probabilities.py`: Generates probability values for images using a pre-trained InceptionV3 model.
2. `kendalls_tau_calculator.py`: Calculates Kendall's Tau correlation coefficients for a set of probability files generated by the first script.

## Usage

### Step 1: Generate probabilities
1. Save the images to be processed in the `cifar10_test/` directory.
2. Run `generate_probabilities.py` to generate probability values for the images using the InceptionV3 model.
3. The script will save the probabilities in `.pkl` files in the working directory.

### Step 2: Calculate Kendall's Tau
1. Save the probability files generated in Step 1 in the `results` directory.
2. Run `kendalls_tau_calculator.py` to compute the Kendall's Tau for each probability file.
3. The script will print the mean and standard deviation of the Kendall's Tau for each label, as well as the overall mean and standard deviation.

## Requirements
- Python 3
- TensorFlow
- Keras
- NumPy
- SciPy
- scikit-image
- OpenCV

## How it Works
- `generate_probabilities.py` uses the pre-trained InceptionV3 model to predict the probability values for each image. The images are perturbed using Gaussian blur and the probabilities are stored in a `.pkl` file.
- `kendalls_tau_calculator.py` reads the `.pkl` files generated in the previous step, computes the Kendall's Tau correlation coefficient between the probabilities for each triplet of images, and outputs the mean and standard deviation of Kendall's Tau for each label and overall.
